{"version":3,"file":"content.js","sources":["../../../Extension/content.js"],"sourcesContent":["async function getWellknown(url) {\n  const response = await fetch(`${url.origin}/.well-known/gpc.json`);\n  let wellknownData;\n  try {\n    wellknownData = await response.json();\n  } catch {\n    wellknownData = null;\n  }\n\n  chrome.runtime.sendMessage({\n    msg: \"DOWNLOAD_WELLKNOWN\",\n    data: wellknownData,\n  });\n}\n\nconst setDom = (state = true) => {\n  if (import.meta.env.VITE_BROWSER === \"safari\") {\n    try {\n      const script_content = `\n        Object.defineProperty(Navigator.prototype, \"globalPrivacyControl\", {\n          get: () => ${state},\n          configurable: true,\n          enumerable: true\n        });\n        document.currentScript.parentElement.removeChild(document.currentScript);\n      `;\n      const script = document.createElement(\"script\");\n      script.innerHTML = script_content;\n      document.documentElement.prepend(script);\n    } catch (err) {\n      console.error(`Failed to set DOM signal: ${err}`);\n    }\n  }\n};\n\n(() => {\n  let url = new URL(location);\n  getWellknown(url);\n  chrome.runtime.sendMessage({\n    msg: \"CHECK_ENABLED\",\n    data: url.hostname,\n  })\n  .then((response) => {\n    if (import.meta.env.VITE_BROWSER === \"safari\" && !navigator.hasOwnProperty(\"globalPrivacyControl\"))\n      if (response.isEnabled) {\n        setDom(true);\n      } else {\n        setDom(false);\n      }\n  });\n  chrome.runtime\n    .sendMessage({\n      msg: \"APP_COMMUNICATION\",\n      type: \"GET_DOMAIN_STATUS\",\n      data: url.hostname,\n    })\n    .then((response) => {\n      console.log(response);\n    });\n})();\n"],"names":["setDom","state","script_content","script","document","createElement","innerHTML","documentElement","prepend","err","console","error","url","URL","location","async","response","fetch","origin","wellknownData","json","chrome","runtime","sendMessage","msg","data","getWellknown","hostname","then","navigator","hasOwnProperty","isEnabled","type","log"],"mappings":"AAeA,MAAMA,EAAS,CAACC,GAAQ,KAEhB,IACF,MAAMC,EAAiB,wGAEND,wKAMXE,EAASC,SAASC,cAAc,UACtCF,EAAOG,UAAYJ,EACVE,SAAAG,gBAAgBC,QAAQL,EAClC,OAAQM,GACCC,QAAAC,MAAM,6BAA6BF,IAC5C,CACF,EACH,MAGM,IAAAG,EAAM,IAAIC,IAAIC,WApCpBC,eAA4BH,GAC1B,MAAMI,QAAiBC,MAAM,GAAGL,EAAIM,+BAChC,IAAAC,EACA,IACcA,QAAMH,EAASI,MACnC,CAAI,MACgBD,EAAA,IACjB,CAEDE,OAAOC,QAAQC,YAAY,CACzBC,IAAK,qBACLC,KAAMN,GAEV,CAwBEO,CAAad,GACbS,OAAOC,QAAQC,YAAY,CACzBC,IAAK,gBACLC,KAAMb,EAAIe,WAEXC,MAAMZ,IAC6Ca,UAAUC,eAAe,0BACrEd,EAASe,UACX/B,GAAO,GAEPA,GAAO,GACR,IAELqB,OAAOC,QACJC,YAAY,CACXC,IAAK,oBACLQ,KAAM,oBACNP,KAAMb,EAAIe,WAEXC,MAAMZ,IACLN,QAAQuB,IAAIjB,EAAQ,GAEtB,EA1BJ"}